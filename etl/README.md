# Проектное задание: ETL

## АЛЕКСАНДР, ПОЖАЛУЙСТА, ОБРАТИТЕ ВНИМАНИЕ НА ЭТОТ КОММЕНТАРИЙ:
## Я ИСПОЛЬЗУЮ ТРЕТЬЮ ВЕРСИЮ БИБЛИОТЕКИ PSYCOPG, В НЕЙ ЗАКРЫВАТЬ КОННЕКШЕН НЕ ОБЯЗАТЕЛЬНО (ПО КРАЙНЕЙ МЕРЕ ТАК НАПИСАНО В ОФИЦИАЛьНОЙ ДОКУМЕНТАЦИИ:
## https://www.psycopg.org/psycopg3/docs/basic/from_pg2.html#diff-with
## https://www.psycopg.org/psycopg3/docs/basic/usage.html#with-connection

## Инструкция по запуску:
1. Клонировать репозиторий в локальную папку.
2. Выполнить docker compose up --build

Проверить результат:
http://127.0.0.1:9200/movies/_search

Тесты для Postman находятся в файле postman_tests.json

## Дополнительно:
Для ES и Redis реализовал контекстные менеджеры для закрытия соединения,
для Postgres не стал, т.к. для третьей версии библиотеки этого делать не нужно, вроде бы:
https://www.psycopg.org/psycopg3/docs/basic/from_pg2.html#diff-with

Датаклассы экстрактера, лоадера и трансформера переделал на обычные, 
действительно, их использовать было не обязательно, для класса модели оставил.